<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>14 検出力分析 | Doing Meta-Analysis in R</title>
<meta name="author" content="Mathias Harrer">
<meta name="author" content="Pim Cuijpers">
<meta name="author" content="Toshi A. Furukawa">
<meta name="author" content="David D. Ebert">
<meta name="description" content="メ...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="14 検出力分析 | Doing Meta-Analysis in R">
<meta property="og:type" content="book">
<meta property="og:description" content="メ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="14 検出力分析 | Doing Meta-Analysis in R">
<meta name="twitter:site" content="@MathiasHarrer">
<meta name="twitter:description" content="メ...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Fira_Sans-0.4.7/font.css" rel="stylesheet">
<link href="libs/Roboto_Mono-0.4.7/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/fira.css">
<style>

    :root {
      --background-color: #FFFEFA;
      --text-color: #000;
      --highlight-color: #277DB0;
      --border-color: #999896;
      --grey-color: #6C6C6C;
      --line-color: #eee;
      --bg-box: #f5f5f5;
      --box-border-color: #eeeeee;
      --code-bg: #f8f8f8;
      --code-chunk-bg: linear-gradient(160deg,#f8f8f8 0, #f1f1f1 100%);
      --code-text-color: #212529;
      --hr-border-top: 1px solid rgba(0,0,0,0.1);
      --table-text-color: #000;
      --toc-active: #eee;
      --form-color: #4D4C4B;
      --form-background-color: #FFFEFA;
      --form-border: 1px solid #999896;
      --aa-cursor-background-color: #B2D7FF;
    }


    [data-theme="dark"] {
      --background-color: #2b2b2b;
      --text-color: #ffffff;
      --highlight-color: #34a8ed;
      --border-color: yellow;
      --grey-color: #cfcfcf;
      --line-color: #575757;
      --bg-box: #474747;
      --box-border-color: #474747;
      --code-bg: #474747;
      --code-chunk-bg: linear-gradient(160deg,#CDCDCD 0,#f1f1f1 100%);
      --code-text-color: #ffffff;
      --hr-border-top: 1px solid #575757;
      --table-text-color: #ffffff;
      --toc-active: #474747;
      --form-color: #cfcfcf;
      --form-background-color: #474747;
      --form-border: 1px solid #575757;
      --aa-cursor-background-color: #2b2b2b;
    }

    .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
      color: var(--form-color);
      border-bottom: 1px var(--form-border) solid;
      background-color: var(--form-background-color);
    }

    .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
      background-color: var(--aa-cursor-background-color);
    }

    strong {
      font-family: "Helvetica Neue",
        Arial,
        "Hiragino Kaku Gothic ProN",
        "Hiragino Sans",
        Meiryo,
        sans-serif;
      font-weight: bolder;
    }

    .form-control {
      color: var(--form-color);
      background-color: var(--form-background-color);
      border: var(--form-border);
    }

    .form-control:focus {
      color: var(--text-color);
      background-color: var(--form-background-color);
      border: var(--form-border);
    }


    nav[data-toggle="toc"] .nav a.nav-link.active, nav[data-toggle="toc"] .nav .nav-link.active > li > a {
        background-color: var(--toc-active);
    }

    .btn-circle.btn-md {
      width: 50px;
      height: 50px;
      padding: 7px 10px;
      border-radius: 25px;
      font-size: 10px;
      text-align: center;
    }


    .lightable-classic td {
      color: var(--text-color);
    }


    .table {
      color: var(--table-text-color);
    }

    hr {
      border-top: var(--hr-border-top);
    }

    code {
      background-color: var(--code-bg);
      color: var(--code-text-color);
    }

    pre {
      background-image: var(--code-chunk-bg);
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }

    a {
      color: var(--highlight-color);
    }

    .header-section-number {
      color: var(--grey-color);
    }

    small.text-muted {
      color: var(--grey-color) !important;
    }


    .firstcharacter {
      color: var(--highlight-color);
    }

    p.caption {
      color: var(--grey-color);
    }

    .figure {
      border-top: 2px solid var(--line-color);
      border-bottom: 2px solid var(--line-color);
    }


    .inline-figure {
      border: 0;
      box-shadow: none;
    }

    .boxinfo {
      padding: 1em 1em 1em 3em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .boxinfo:before {
        content: '\f0eb';
        font-family: FontAwesome;
        left:20px;
        position:absolute;
        font-size: 30px;
        color: var(--highlight-color);
     }

    .boxempty {
      padding: 1em 1em 1em 1.1em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .boxempty:before {
        content: '\f0eb';
        font-family: FontAwesome;
        left:0px;
        position:absolute;
        font-size: 30px;
        color: transparent;
     }

    .boximportant {
      padding: 1em 1em 1em 3em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .boximportant:before {
        content: '\f06a';
        font-family: FontAwesome;
        left:13px;
        position:absolute;
        font-size: 30px;
        color: var(--highlight-color);
     }

    .boxreport {
      padding: 1em 1em 1em 3em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .boxreport:before {
        content: '\f570';
        font-family: FontAwesome;
        left:15px;
        position:absolute;
        font-size: 30px;
        color: var(--highlight-color);
     }

    .boxdmetar {
      padding: 1em 1em 1em 3em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .csl-entry {
      margin-bottom: 20px;
      padding-left: 1.5em;
      text-indent:-1.5em;
    }

    .boxdmetar:before {
        content: '\f4f7';
        font-family: FontAwesome;
        left:10px;
        position:absolute;
        font-size: 30px;
        color: var(--highlight-color);
     }

    .boxquestion {
      padding: 1em 1em 1em 3em;
      margin-bottom: 10px;
      background: var(--bg-box);
      position:relative;
      border-width: 3px;
      border-style: solid;
      border-color: var(--box-border-color);
      border-radius: .25rem;
    }

    .boxquestion:before {
        content: '\f059';
        font-family: FontAwesome;
        left:12px;
        position:absolute;
        font-size: 30px;
        color: var(--highlight-color);
     }

    .mode-switch {
      font-size: 0.9rem;
    }

    img {
      max-width: 100%;
      height: auto;
      border-radius: .25rem;
    }


    .firstcharacter {
      color: var(--highlight-color);
      float: left;
      font-size: 40px;
      line-height: 50px;
      padding-bottom: 2px;
      padding-right: 8px;
      padding-left: 2px;
    }


    .btn-circle.btn-sm {
        width: 30px;
        height: 30px;
        padding: 6px 0px;
        border-radius: 15px;
        font-size: 20px;
        text-align: center;
    }
    .btn-circle.btn-md {
        width: 50px;
        height: 50px;
        padding: 7px 10px;
        border-radius: 25px;
        font-size: 20px;
        text-align: center;
    }
    .btn-circle.btn-xl {
        width: 60px;
        height: 60px;
        padding: 7px 7px;
        border-radius: 35px;
        font-size: 30px;
        text-align: center;
    }

    #critical-btn.btn-secondary {
      background-color: var(--grey-color);
      border-color: var(--grey-color);
    }

    .sticky-item {
        position: fixed;
        bottom: 30px;
        right: 30px;
    }



    </style>
<link rel="shortcut icon" href="favicon.ico">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');

      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script><script type="text/javascript">
      // Add switch element
      document.addEventListener('DOMContentLoaded', function(event){
        let darkSwitch = document.createElement('div');
        darkSwitch.innerHTML = "<div class='sticky-item'><button type='button' id='critical-btn' class='btn btn-dark btn-circle btn-xl'>🌓</button></div>"
        document.body.appendChild(darkSwitch);
      })

    $(document).ready(function() {

        $("#critical-btn").click(function () {

            if ($(this).hasClass('btn-dark')){
                $('#critical-btn').removeClass('btn-dark').addClass('btn-secondary');
                $(this).addClass('btn-secondary').removeClass('btn-dark');
            }

            else if ($(this).hasClass('btn-secondary')){
                $('#critical-btn').removeClass('btn-secondary').addClass('btn-dark');
                $(this).addClass('btn-dark').removeClass('btn-secondary');
            }

        })
    })
    </script><script type="text/javascript">
      // Wait for document to load
      document.addEventListener("DOMContentLoaded", function(event) {
        document.documentElement.setAttribute("data-theme", "light");

        // Get our button switcher
        var themeSwitcher = document.getElementById("critical-btn");

        // When our button gets clicked
        themeSwitcher.onclick = function() {
          // Get the current selected theme, on the first run
          // it should be `light`
          var currentTheme = document.documentElement.getAttribute("data-theme");

          // Switch between `dark` and `light`
          var switchToTheme = currentTheme === "dark" ? "light" : "dark"

          // Set our currenet theme to the new one
          document.documentElement.setAttribute("data-theme", switchToTheme);

          // Save current selection
          localStorage.setItem('themeMode', switchToTheme);

        }
      });

      // keep selection across pages
      document.addEventListener('DOMContentLoaded', function(event){
        const currentTheme = localStorage.getItem('themeMode')
        if (currentTheme === 'dark'){
        document.documentElement.setAttribute("data-theme", 'dark');
          if ($("#critical-btn").hasClass('btn-dark')) {
            $('#critical-btn').removeClass('btn-dark').addClass('btn-secondary');
            $('#critical-btn').addClass('btn-secondary').removeClass('btn-dark');
          }
        } else {
        document.documentElement.setAttribute("data-theme", 'light');
          if ($("#critical-btn").hasClass('btn-secondary')) {
            $('#critical-btn').removeClass('btn-secondary').addClass('btn-dark');
            $('#critical-btn').addClass('btn-dark').removeClass('btn-secondary');
          }
      }})
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A Hands-on Guide">Doing Meta-Analysis in R</a>:
        <small class="text-muted">A Hands-on Guide</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">ようこそ！</a></li>
<li><a class="" href="preface.html">序章</a></li>
<li><a class="" href="about-the-authors.html">著者について</a></li>
<li class="book-part">はじめに</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> はじめに</a></li>
<li><a class="" href="discovering-R.html"><span class="header-section-number">2</span> R の発見</a></li>
<li class="book-part">Rでメタ分析</li>
<li><a class="" href="effects.html"><span class="header-section-number">3</span> 効果量</a></li>
<li><a class="" href="pooling-es.html"><span class="header-section-number">4</span> 効果量のプール</a></li>
<li><a class="" href="heterogeneity.html"><span class="header-section-number">5</span> 研究間異質性</a></li>
<li><a class="" href="forest.html"><span class="header-section-number">6</span> フォレストプロット</a></li>
<li><a class="" href="subgroup.html"><span class="header-section-number">7</span> サブグループ解析</a></li>
<li><a class="" href="metareg.html"><span class="header-section-number">8</span> メタ回帰</a></li>
<li><a class="" href="pub-bias.html"><span class="header-section-number">9</span> 出版バイアス</a></li>
<li class="book-part">高度な分析</li>
<li><a class="" href="multilevel-ma.html"><span class="header-section-number">10</span> 「マルチレベル」メタ分析</a></li>
<li><a class="" href="sem.html"><span class="header-section-number">11</span> 構造方程式モデリングメタ分析</a></li>
<li><a class="" href="netwma.html"><span class="header-section-number">12</span> ネットワークメタ分析</a></li>
<li><a class="" href="bayesian-ma.html"><span class="header-section-number">13</span> ベイズメタ分析</a></li>
<li class="book-part">各種ツール</li>
<li><a class="active" href="power.html"><span class="header-section-number">14</span> 検出力分析</a></li>
<li><a class="" href="risk-of-bias-plots.html"><span class="header-section-number">15</span> バイアスリスクのプロット</a></li>
<li><a class="" href="reporting-reproducibility.html"><span class="header-section-number">16</span> 報告と再現性</a></li>
<li><a class="" href="es-calc.html"><span class="header-section-number">17</span> 効果量の計算と換算</a></li>
<li class="book-part">付録</li>
<li><a class="" href="qanda.html"><span class="header-section-number">A</span> Q&amp;A</a></li>
<li><a class="" href="formula.html"><span class="header-section-number">B</span> 効果量の計算式</a></li>
<li><a class="" href="symbollist.html"><span class="header-section-number">C</span> シンボルマーク一覧</a></li>
<li><a class="" href="attr.html"><span class="header-section-number">D</span> R およびパッケージ情報</a></li>
<li><a class="" href="corrections.html"><span class="header-section-number">E</span> 訂正・備考</a></li>
<li><a class="" href="%E6%9C%AC%E6%9B%B8%E3%81%AE%E5%BC%95%E7%94%A8.html">本書の引用</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="power" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> 検出力分析<a class="anchor" aria-label="anchor" href="#power"><i class="fas fa-link"></i></a>
</h1>
<hr>
<div class="inline-figure"><img src="_figs/power_analysis.jpg"></div>
<p><br></p>
<p></p>
<p><span class="firstcharacter">メ</span>
タ分析が有用な理由の一つは、<strong>不正確な</strong>知見を複数組み合わせて、より<strong>正確な</strong>知見を得ることができるためである。ほとんどの場合、メタ分析は、含まれるどの研究よりも狭い信頼区間を持つ推定値を生成する。これは、真の効果が小さい場合に特に有効である。一次研究では小さな効果の有意性を確認できないだろうが、メタ分析による推定値は、そのような小さな効果が存在することを確認するために必要な統計的検出力を提供できることが多いのである。</p>
<p>
</p>
<p>しかし、統計的検出力の不足は、メタ分析においてさえも重要な役割を果たすことがある。多くのメタ分析で含まれる研究の数は少なく、<span class="math inline">\(K=\)</span> 10 件以下であることが多い。例えば、コクランのシステマティックレビューにおける研究の数の中央値は6である <span class="citation">(<a href="references.html#ref-borenstein2011introduction">Borenstein et al. 2011</a>)</span>。メタ分析にはサブグループ分析やメタ回帰が含まれることが多く、その場合はさらに検出力が必要となることを考慮すると、この問題はさらに深刻になる。さらに、多くのメタ分析では、研究間の異質性が高い。これもまた全体的な精度を低下させ、結果として統計的検出力を低下させる。</p>
<p>統計的検出力の概念については、Chapter <a href="pub-bias.html#p-curve-es">9.2.2.2</a> ですでに触れ、p-曲線法について学んだ。統計的検出力の背後にある考え方は、古典的な仮説検定に由来している。これは仮説検定で起こりうる2種類の<strong>エラー</strong>に直接関係している。最初のエラーは、帰無仮説 (<span class="math inline">\(\mu_1 = \mu_2\)</span>) が真であるのに、対立仮説 (<span class="math inline">\(\mu_1 \neq \mu_2\)</span> ) を受け入れることである。これは、<strong>タイプ I</strong> または <span class="math inline">\(\alpha\)</span> エラーとしても知られている。逆に、対立仮説が真であるのに、帰無仮説を受け入れることもある。これは、<strong>タイプ II</strong> または <span class="math inline">\(\beta\)</span> エラーとして知られている<strong>偽陰性</strong> (false negative) を発生させる。</p>
<p></p>
<p>検定の検出力は、<span class="math inline">\(\beta\)</span> に直接依存し、検出力 = <span class="math inline">\(1 - \beta\)</span> と定義される。帰無仮説では、2群の平均の間に差がないと仮定し、対立仮説では差 (すなわち「効果」) が存在すると仮定する。統計的検出力は、効果 (つまり、平均値の差) が存在する場合に、検定がそれを検出する確率として定義できる。</p>
<p><span class="math display" id="eq:pow1">\[\begin{equation}
\text{Power} = P(\text{reject H}_0~|~\mu_1 \neq \mu_2) = 1 - \beta
\tag{14.1}
\end{equation}\]</span></p>
<p>タイプ I の誤りはタイプ II の誤りよりも重大であると考えるのが一般的である。したがって、<span class="math inline">\(\alpha\)</span> レベルは慣習的に 0.05 に設定され、<span class="math inline">\(\beta\)</span> レベルは0.2に設定されている。つまり、<span class="math inline">\(1-\beta\)</span> = 1 - 0.2 = 80% という閾値をもたらし、通常、検定の統計的検出力が適切かどうかを決定するのに使われる。研究者が新しい研究を計画するとき、通常、80% の検出力が保証されるサンプルサイズを選択する。真の効果が大きければ、統計的に有意な結果を得ることは容易である。したがって、検出力が 80% に固定されている場合、必要なサンプルサイズは真の効果の大きさにのみ依存する。想定される効果が小さいほど、80% の検出力を確保するために必要なサンプルサイズは大きくなる。</p>
<p>一次研究を行う研究者は、発見されると予想される効果量に基づいて、<strong>a priori</strong> に、サンプルのサイズを計画することができる。メタ分析では公表されたものしか扱えないため、状況は異なる。しかし、メタ分析に含める研究の数や種類については、ある程度コントロールすることができる (例えば、より緩やかな、あるいは厳しい包含基準を定義する)。こうすることで、全体の検出力を調整することもできる。メタ分析における統計的検出力に影響を与える要因はいくつかある。</p>
<ul>
<li><p>対象研究の<strong>総数</strong>とその<strong>サンプルサイズ</strong>。どれくらいの数の研究を見込んでいるのか、またその数は少ないのか多いのか。</p></li>
<li><p>見つけたい効果量。これは特に重要で、効果量がどの程度大きければ意味があるのかを仮定しなければならないことがある。例えば、あるうつ病の介入研究では、SMD = 0.24 という小さい効果でも患者にとって意味がある可能性があると計算されている <span class="citation">(<a href="references.html#ref-cuijpers2014threshold">Pim Cuijpers et al. 2014</a>)</span>。介入の負の効果 (例えば、死亡や症状の悪化) を研究したい場合、非常に小さな効果量であっても極めて重要であり、検出されるべきものである。</p></li>
<li><p>予想される研究間の異質性。異質性が大きいとメタ分析による推定値の精度と、その結果、有意な効果を見出す可能性にも影響する。</p></li>
</ul>
<p>上記以外にも、サブグループ分析など、実施したい分析について考えることも重要である。各サブグループにはどれくらいの研究があるのか？各グループでどのような効果を見出したいのか？</p>
<p></p>
<div class="boximportant">
<p>
<strong>Post-Hoc 検出力検定: 「検出力の乱用」</strong>
</p>
<p>
検出力分析は、必ず <strong>a
priori</strong>、つまりメタ分析を実行する<strong>前</strong>に行わなければならない。
</p>
<p>
分析の<strong>後</strong>に行われる検出力分析 (「post hoc 分析」)
は、深い欠陥のある論理に基づいている <span class="citation"><span class="citation">(<a href="references.html#ref-hoenig2001abuse">Hoenig and Heisey 2001</a>)</span></span> 。まず、post hoc
の検出力分析は、<strong>一様</strong>であり、まだ知らないことは何も教えてくれない。収集したサンプルに基づいて効果が有意でないことがわかったとき、計算された
post hoc 検出力は、定義上、不十分 (すなわち、50% 以下)
である。あるテストの post hoc に検出力を計算するとき、単に結果の <span class="math inline"><span class="math inline">\(p\)</span></span>
値に直接リンクしている検出力関数で「遊んで」いるにすぎない。
</p>
<p>
post-hoc の検出力の推定値には、<span class="math inline"><span class="math inline">\(p\)</span></span>
値がまだ教えてくれていないことはない。すなわち、検定の効果とサンプルサイズに基づいて、検出力が統計的有意性を確認するのに不十分であることを示している。
</p>
<p>
post hoc に検出力を解釈すると、<strong>power approach
paradox</strong> (PAP)
にもつながる。このパラドックスは、有意な効果をもたらさない分析では、p値が<strong>小さい</strong>と、帰無仮説が真であるという<strong>より多くの</strong>証拠を示すと考えられ、真の効果を検出する力が<strong>高く</strong>なるために生じる。<!-- needs more explanation-->
</p>
</div>
<p><br></p>
<div id="固定効果モデル" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> 固定効果モデル<a class="anchor" aria-label="anchor" href="#%E5%9B%BA%E5%AE%9A%E5%8A%B9%E6%9E%9C%E3%83%A2%E3%83%87%E3%83%AB"><i class="fas fa-link"></i></a>
</h2>
<hr>
<p></p>
<p>固定効果モデルの下でのメタ分析の検出力を決定するために、対立仮説が正しいことを表す分布を指定しなければならない。しかし、これを行うには、単に <span class="math inline">\(\theta \neq 0\)</span> (すなわち、<strong>何らかの</strong>効果が存在する) というだけでは不十分である。十分な検出力 (80%) で検出したい<strong>特定の</strong>真の効果を仮定しなければならない。例えば、SMD = 0.29 である。</p>
<p>効果量をその標準誤差で割ると <span class="math inline">\(z\)</span> スコアになることは、以前すでに取り上げた (Chapter <a href="metareg.html#metareg-continuous">8.1.2</a> を参照)。<span class="math inline">\(z\)</span> スコアは、標準正規分布に従う。ここで、<span class="math inline">\(|z| \geq\)</span> 1.96 という値は、効果がゼロとは有意に異なることを意味する (<span class="math inline">\(p&lt;\)</span> 0.05)。これはまさにメタ分析で達成したいことである。つまり、結果の正確な効果量と標準誤差がどんなに大きくても、<span class="math inline">\(|z|\)</span> の値は少なくとも 1.96 でなければならず、したがって統計的に有意でなければならない。</p>
<p><span class="math display" id="eq:pow2">\[\begin{equation}
z  = \frac{\theta}{\sigma_{\theta}}~~~\text{where}~~~|z| \geq 1.96.
\tag{14.2}
\end{equation}\]</span></p>
<p>プール効果量の標準誤差である <span class="math inline">\(\sigma_{\theta}\)</span> (「シグマ・シータ」と読む) の値は、以下の式を用いて計算することができる。</p>
<p><span class="math display" id="eq:pow3">\[\begin{equation}
\sigma_{\theta}=\sqrt{\frac{\left(\frac{n_1+n_2}{n_1n_2}\right)+\left(\frac{\theta^2}{2(n_1+n_2)}\right)}{K}}
\tag{14.3}
\end{equation}\]</span></p>
<p>ここで、<span class="math inline">\(n_1\)</span> と <span class="math inline">\(n_2\)</span> は、ある研究のグループ1とグループ2のサンプルサイズを表し、<span class="math inline">\(\theta\)</span>は、想定される効果量 (標準化平均差を表している)、<span class="math inline">\(K\)</span> は、メタ分析における研究の総数である。重要なのは、簡略化のため、この式は、両群のサンプルサイズが、含まれるすべての研究において同一であると仮定していることである。</p>
<p>この式は、標準化平均差の標準誤差を計算するのに使われる式と非常によく似ているが、1つだけ例外がある。ここで、標準誤差を <span class="math inline">\(K\)</span> で割る。これは、プール効果標準誤差が、メタ分析における研究の総数を表す係数 <span class="math inline">\(K\)</span> によって減少することを意味する。言い換えれば、固定効果モデルを仮定した場合、研究をプールすると、全体効果の精度が <span class="math inline">\(K\)</span>-倍になる<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;このステートメントは、もちろん、方程式 &lt;a href="power.html#eq:pow3"&gt;(14.3)&lt;/a&gt; の簡易式を使用しているため正しいことに注意&lt;/p&gt;'><sup>72</sup></a>。</p>
<p><span class="math inline">\(\theta\)</span> を定義し、<span class="math inline">\(K\)</span> を計算した結果、<span class="math inline">\(z\)</span> という値になる。この <span class="math inline">\(z\)</span> スコアは、群サイズ <span class="math inline">\(n_1\)</span> と <span class="math inline">\(n_2\)</span> を持つ <span class="math inline">\(K\)</span> 件の研究がある場合、メタ分析の検出力を得るために使用することができる。</p>
<p><span class="math display" id="eq:pow4">\[\begin{align}
\text{Power} &amp;= 1-\beta \notag \\
             &amp;= 1-\Phi(c_{\alpha}-z)+\Phi(-c_{\alpha}-z) \notag \\
             &amp;= 1-\Phi(1.96-z)+\Phi(-1.96-z). \tag{14.4}
\end{align}\]</span></p>
<p></p>
<p>ここで、<span class="math inline">\(c_{\alpha}\)</span> は、指定された <span class="math inline">\(\alpha\)</span> レベルが与えられたときの、標準正規分布の臨界値である。記号 <span class="math inline">\(\Phi\)</span> (「ファイ」と読む) は、標準正規分布の<strong>累積分布関数</strong> (cumulative distribution function, CDF) である <span class="math inline">\(\Phi(z)\)</span> を表す。 <em>R</em> では、標準正規分布の CDF は <code>pnorm</code> 関数で実装されている。</p>
<p>この公式は、固定効果メタ分析の検出力を計算するために使用できる。<span class="math inline">\(K=\)</span> 10 件の研究があり、両群がそれぞれ約25人の参加者を持つと仮定しよう。SMD = 0.2 の効果を検出できるようにしたい。このようなメタ分析にはどのような検出力があるか？</p>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 仮定条件を定義</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span></span>
<span><span class="co"># プール効果の標準誤差を計算</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n1</span><span class="op">*</span><span class="va">n2</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="va">theta</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">K</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># z を計算</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="va">theta</span><span class="op">/</span><span class="va">sigma</span></span>
<span></span>
<span><span class="co"># 検出力を計算</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1.96</span><span class="op">-</span><span class="va">z</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.96</span><span class="op">-</span><span class="va">z</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.6059151</code></pre>
<p>このメタ分析には 10 件の研究が含まれているにもかかわらず、60.6%と<strong>検出力不足</strong>であることがわかる。固定効果メタ分析の検出力を計算するには、<code>power.analysis</code> 関数を使用する方が便利である。</p>
<p></p>
<div class="boxdmetar">
<p>
<strong>“power.analysis” 関数</strong>
</p>
<p>
<code>power.analysis</code> 関数は、<strong>{dmetar}</strong>
パッケージに含まれている。<strong>{dmetar}</strong>
がインストールされ、コンピュータに読み込まれると、この関数を使用できるようになる。もし、<strong>{dmetar}</strong>
をインストールして<strong>いない</strong>場合は、以下の手順でインストールできる。
</p>
<ol style="list-style-type: decimal">
<li>
関数のソースコードにアクセスする <a href="https://raw.githubusercontent.com/MathiasHarrer/dmetar/master/R/power.analysis.subgroup.R">オンライン</a>.
</li>
<li>
ソースコード全体をコンソール (R Studio の左下ペイン)
にコピー＆ペーストし、Enterキーを押して、 <em>R</em>
に関数を「学習」させる。
</li>
<li>
<strong>{ggplot2}</strong>
パッケージがインストールされ、ロードされていることを確認する。
</li>
</ol>
</div>
<p><code>power.analyze</code> 関数は、以下の引数を含む。</p>
<ul>
<li><p><strong><code>d</code></strong>. 標準化平均差 (SMD) で表される仮説的な、または妥当な総合効果量。効果量は正の数値でなければならない。</p></li>
<li><p><strong><code>OR</code></strong>. 治療や介入の効果をコントロールと比較して想定したもので、オッズ比 (OR) で表される。<code>d</code> と <code>OR</code> の両方が指定された場合、結果は <code>d</code> の値に対してのみ計算される。</p></li>
<li><p><strong><code>k</code></strong>. メタ分析に含まれると予測される研究数。</p></li>
<li><p><strong><code>n1</code></strong>, <strong><code>n2</code></strong>. 対象研究の第1群、第2群における平均サンプルサイズの予測値。</p></li>
<li><p><strong><code>p</code></strong>. 使用するアルファ値。デフォルトは <span class="math inline">\(\alpha\)</span> =0.05。</p></li>
<li><p><strong><code>heterogeneity</code></strong>. 研究間の異質性のレベル。固定効果モデルで異質性がない場合は <code>"fixed"</code>、異質性が低い場合は <code>"low"</code>、異質性が中程度の場合は <code>"moderate"</code>、異質性が高い場合は <code>"high"</code> を指定することができる。デフォルトは <code>"fixed"</code>。</p></li>
</ul>
<p>先ほどの例と同じ入力で、この関数を試してみよう。</p>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dmetar.protectlab.org">dmetar</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="http://dmetar.protectlab.org/reference/power.analysis.html">power.analysis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>               k <span class="op">=</span> <span class="fl">10</span>, </span>
<span>               n1 <span class="op">=</span> <span class="fl">25</span>, </span>
<span>               n2 <span class="op">=</span> <span class="fl">25</span>, </span>
<span>               p <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Fixed-effect model used.</code></pre>
<div class="inline-figure"><img src="Doing_Meta_Analysis_in_R_files/figure-html/unnamed-chunk-461-1.png" width="55%" style="display: block; margin: auto;"></div>
<pre><code>## Power: 60.66%</code></pre>
<p><br></p>
</div>
<div id="ランダム効果モデル" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> ランダム効果モデル<a class="anchor" aria-label="anchor" href="#%E3%83%A9%E3%83%B3%E3%83%80%E3%83%A0%E5%8A%B9%E6%9E%9C%E3%83%A2%E3%83%87%E3%83%AB"><i class="fas fa-link"></i></a>
</h2>
<hr>
<p></p>
<p>ランダム効果モデルを仮定した検出力分析の場合、研究間の異質性分散 <span class="math inline">\(\tau^2\)</span> を考慮する必要がある。したがって、標準誤差の適合版、<span class="math inline">\(\sigma^*_{\theta}\)</span> を計算する必要がある。</p>
<p><span class="math display" id="eq:pow5">\[\begin{equation}
\sigma^*_{\theta}=\sqrt{\frac{\left(\frac{n_1+n_2}{n_1n_2}\right)+\left(\frac{\theta^2}{2(n_1+n_2)}\right)+\tau^2}{K}}
\tag{14.5}
\end{equation}\]</span></p>
<p>問題は、<span class="math inline">\(\tau^2\)</span> の値は、通常、データを見る前にはわからないということである。しかし、Hedges and Pigott <span class="citation">(<a href="references.html#ref-hedges2001power">2001</a>)</span> は、研究間異質性が低い、中程度、高い場合にモデル化するために使用することができるガイドラインを提供している。</p>
<p><strong>低い異質性:</strong></p>
<p><span class="math display" id="eq:pow6">\[\begin{equation}
\sigma^*_{\theta} = \sqrt{1.33\times\dfrac{\sigma^2_{\theta}}{K}}
\tag{14.6}
\end{equation}\]</span></p>
<p><strong>中程度の異質性:</strong></p>
<p><span class="math display" id="eq:pow7">\[\begin{equation}
\sigma^*_{\theta} = \sqrt{1.67\times\dfrac{\sigma^2_{\theta}}{K}}
\tag{14.7}
\end{equation}\]</span></p>
<p><strong>高い異質性:</strong></p>
<p><span class="math display" id="eq:pow8">\[\begin{equation}
\sigma^*_{\theta} = \sqrt{2\times\dfrac{\sigma^2_{\theta}}{K}}
\tag{14.8}
\end{equation}\]</span></p>
<p>また、<code>power.analyze</code> 関数はランダム効果メタ分析に使用することができる。異質性引数 <code>heterogeneity</code> を用いて、想定される研究間の異質性の大きさを制御することができる。設定可能な値は <code>"low"</code>、<code>"moderate"</code>、<code>"high"</code> である。前の例と同じ値を用いて、研究間の異質性が中程度の場合の期待検出力を計算してみよう。</p>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://dmetar.protectlab.org/reference/power.analysis.html">power.analysis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>               k <span class="op">=</span> <span class="fl">10</span>, </span>
<span>               n1 <span class="op">=</span> <span class="fl">25</span>, </span>
<span>               n2 <span class="op">=</span> <span class="fl">25</span>, </span>
<span>               p <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               heterogeneity <span class="op">=</span> <span class="st">"moderate"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Random-effects model used (moderate heterogeneity assumed). 
## Power: 40.76%</code></pre>
<p>推定された検出力は 40.76% であることがわかる。これは、標準的な 80% の閾値よりも低い値である。また、固定効果モデルを仮定した場合の 60.66% よりも低くなっている。これは、研究間の異質性がプール効果の推定値の精度を低下させ、その結果、統計的検出力が低下するためである。</p>
<p>Figure <a href="power.html#fig:power">14.1</a> は、 真の効果量、研究数、研究間の異質性の量がメタ分析の検出力に及ぼす影響を可視化している<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;様々な仮定の下でメタ分析の検出力を素早くチェックしたい場合は、この目的のために開発された&lt;strong&gt;検出力計算ツール&lt;/strong&gt;も使用できる。このツールは、この章で取り上げるのと同じ &lt;em&gt;R&lt;/em&gt; 関数に基づくものである。&lt;a href="https://mathiasharrer.shinyapps.io/power_calculator_meta_analysis/" class="uri"&gt;https://mathiasharrer.shinyapps.io/power_calculator_meta_analysis/&lt;/a&gt; にある。&lt;/p&gt;'><sup>73</sup></a>。</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:power"></span>
<img src="Doing_Meta_Analysis_in_R_files/figure-html/power-1.png" alt="ランダム効果メタアナリシスの検出力 (各研究 $n$=50)。色が濃いほど、研究間の異質性が高い。" width="55%"><p class="caption">
Figure 14.1: ランダム効果メタアナリシスの検出力 (各研究 <span class="math inline">\(n\)</span>=50)。色が濃いほど、研究間の異質性が高い。
</p>
</div>
<p><br></p>
</div>
<div id="power-subgroup" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> サブグループ解析<a class="anchor" aria-label="anchor" href="#power-subgroup"><i class="fas fa-link"></i></a>
</h2>
<hr>
<p></p>
<p>サブグループ分析を計画する際、自由に使える研究数がある場合、2群間の差がどの程度大きければ検出できるかを知ることが重要になることがある。これは、サブグループの差のための検出力分析を適用できる条件である。 <em>R</em> では、Hedges and Pigott <span class="citation">(<a href="references.html#ref-hedges2004power">2004</a>)</span> のアプローチを実装した <code>power.analysis.subgroup</code> 関数を用いてサブグループの検出力分析を行うことができる。</p>
<div class="boxdmetar">
<p>
<strong><code>power.analysis.subgroup</code> 関数</strong>
</p>
<p>
<code>power.analysis.subgroup</code>
関数は、<strong>{dmetar}</strong>
パッケージに含まれている。<strong>{dmetar}</strong>
がインストールされ、コンピュータに読み込まれると、この関数を使用できるようになる。もし、<strong>{dmetar}</strong>
をインストールして<strong>いない</strong>場合は、以下の手順でインストールできる。
</p>
<ol style="list-style-type: decimal">
<li>
関数のソースコードにアクセスする <a href="https://raw.githubusercontent.com/MathiasHarrer/dmetar/master/R/power.analysis.subgroup.R">オンライン</a>.
</li>
<li>
ソースコード全体をコンソール (R Studio の左下ペイン)
にコピー＆ペーストし、Enterキーを押して、 <em>R</em>
に関数を「学習」させる。
</li>
<li>
<strong>{ggplot2}</strong>
パッケージがインストールされ、ロードされていることを確認する。
</li>
</ol>
</div>
<p>グループ１の効果は SMD = 0.3、標準誤差は 0.13 であり、グループ２の効果は SMD = 0.66、標準誤差は 0.14 であると仮定しよう。これらの仮定条件を関数の呼び出しの入力として使用することができる。</p>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://dmetar.protectlab.org/reference/power.analysis.subgroup.html">power.analysis.subgroup</a></span><span class="op">(</span>TE1 <span class="op">=</span> <span class="fl">0.30</span>, TE2 <span class="op">=</span> <span class="fl">0.66</span>, </span>
<span>                        seTE1 <span class="op">=</span> <span class="fl">0.13</span>, seTE2 <span class="op">=</span> <span class="fl">0.14</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Minimum effect size difference needed for sufficient power: 0.536 (input: 0.36)
## Power for subgroup difference test (two-tailed): 46.99%</code></pre>
<div class="inline-figure"><img src="Doing_Meta_Analysis_in_R_files/figure-html/unnamed-chunk-464-1.png" width="55%" style="display: block; margin: auto;"></div>
<p>この出力では、想像上のサブグループ検定の検出力 (47%) が十分でないことがわかる。出力は、他のすべてが同じで、十分な検出力に達するには、効果量の差が少なくとも 0.54 である必要があることも教えてくれる。</p>
<p><span class="math display">\[\tag*{$\blacksquare$}\]</span></p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="bayesian-ma.html"><span class="header-section-number">13</span> ベイズメタ分析</a></div>
<div class="next"><a href="risk-of-bias-plots.html"><span class="header-section-number">15</span> バイアスリスクのプロット</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#power"><span class="header-section-number">14</span> 検出力分析</a></li>
<li><a class="nav-link" href="#%E5%9B%BA%E5%AE%9A%E5%8A%B9%E6%9E%9C%E3%83%A2%E3%83%87%E3%83%AB"><span class="header-section-number">14.1</span> 固定効果モデル</a></li>
<li><a class="nav-link" href="#%E3%83%A9%E3%83%B3%E3%83%80%E3%83%A0%E5%8A%B9%E6%9E%9C%E3%83%A2%E3%83%87%E3%83%AB"><span class="header-section-number">14.2</span> ランダム効果モデル</a></li>
<li><a class="nav-link" href="#power-subgroup"><span class="header-section-number">14.3</span> サブグループ解析</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Doing Meta-Analysis in R</strong>: A Hands-on Guide" was written by Mathias Harrer, Pim Cuijpers, Toshi A. Furukawa, David D. Ebert. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
